{% if activemq_ha_enabled and not activemq_replication and not activemq_shared_storage %}
        <live-only>
            <scale-down>
{% for param in activemq_connectors %}
{% if param.name != 'artemis' %}
            <connector-ref>{{ param.name }}</connector-ref>
{% endif %}
{% endfor %}
            </scale-down>
        </live-only>
{% endif %}
{% if activemq_ha_enabled and activemq_shared_storage %}
        <shared-store>
{% if activemq_ha_role == 'slave' or activemq_ha_role == 'backup' %}
          <{{ activemq_ha_role }}>
            <allow-failback>{{ activemq_ha_allow_failback }}</allow-failback>
            <restart-backup>{{ activemq_ha_restart_backup }}</restart-backup>
          </{{ activemq_ha_role }}>
{% elif activemq_ha_role == 'master' or activemq_ha_role == 'primary' %}
          <{{ activemq_ha_role }}>
            <failover-on-shutdown>{{ activemq_ha_failover_on_shutdown }}</failover-on-shutdown>
          </{{ activemq_ha_role }}>
{% endif %}
        </shared-store>
{% endif %}
{% if activemq_ha_enabled and activemq_replication %}
        <replication>
{% if activemq_ha_role == 'slave' or activemq_ha_role == 'backup' or amq_broker_replicated %}
          <{{ activemq_ha_role }}>
            <allow-failback>{{ activemq_ha_allow_failback }}</allow-failback>
            <restart-backup>{{ activemq_ha_restart_backup }}</restart-backup>
{% if activemq_ha_replication_cluster_name | length > 0 %}
            <cluster-name>{{ activemq_ha_replication_cluster_name }}</cluster-name>
{% endif %}
{% if activemq_ha_replication_group_name | length > 0 %}
            <group-name>{{ activemq_ha_replication_group_name }}</group-name>
{% endif %}
          </{{ activemq_ha_role }}>
{% elif activemq_ha_role == 'master' or activemq_ha_role == 'primary' %}
          <{{ activemq_ha_role }}>
            <check-for-active-server>{{ activemq_ha_check_for_active_server }}</check-for-active-server>
{% if activemq_ha_replication_cluster_name | length > 0 %}
            <cluster-name>{{ activemq_ha_replication_cluster_name }}</cluster-name>
{% endif %}
{% if activemq_ha_replication_group_name | length > 0 %}
            <group-name>{{ activemq_ha_replication_group_name }}</group-name>
{% endif %}
          </{{ activemq_ha_role }}>
{% endif %}
        </replication>
{% endif %}
